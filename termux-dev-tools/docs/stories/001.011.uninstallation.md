# Story 1.11: Uninstallation

## Status
- Approved

## Story
**As a** user,
**I want** a clean and comprehensive uninstall script,
**so that** I can easily and safely remove all components of the installed development environment.

## Acceptance Criteria
1. An `uninstall.sh` script must be created and placed in a predictable location.
2. The script must remove all CLI tools that were installed by the installer.
3. The script must remove all generated command shims from the binary directory.
4. The script must restore the user's original `.bashrc` or `.zshrc` from the backup file.
5. The script must remove the cloned project repository directory.
6. The script must ask for explicit user confirmation before attempting to remove the `proot-distro` Ubuntu image, as this is a highly destructive and potentially slow operation.

## Tasks / Subtasks
- [ ] **Task 1: Create Uninstall Script (AC: #1)**
    - [ ] Create a new script, `scripts/uninstall.sh`.
- [ ] **Task 2: Remove CLIs and Shims (AC: #2, #3)**
    - [ ] For each CLI tool, run the appropriate uninstall command (e.g., `npm uninstall -g`).
    - [ ] Delete the shim files from `$PREFIX/bin`.
- [ ] **Task 3: Restore Shell Config (AC: #4)**
    - [ ] Check for the `.bak` file.
    - [ ] If it exists, replace the modified rc file with the backup.
- [ ] **Task 4: Remove Cloned Repo (AC: #5)**
    - [ ] Remove the project directory created during installation.
- [ ] **Task 5: Proot Removal Logic (AC: #6)**
    - [ ] Use `read -p` to ask the user for confirmation (`y/n`).
    - [ ] If the user confirms, run `proot-distro remove ubuntu`.

## Dev Notes
- **Source Tree**: The main script will be `scripts/uninstall.sh`.
- **Safety**: This script is destructive by nature. It's critical to be precise and to ask for confirmation before performing the most destructive actions, like removing the Ubuntu image.
- **Clarity**: The script should be very clear in its output about what it is removing at each step.

### Testing
- **Test File Location**: `tests/test-uninstall.sh`
- **Test Standards**: Testing will involve creating a dummy installation (fake files, fake configs) and then running the uninstall script to ensure it cleans everything up correctly.
- **Requirements**:
    - Test that all specified files and directories are removed.
    - Test that the shell configuration is correctly restored from the backup.
    - Test the user confirmation logic for proot removal, ensuring it does *not* remove on 'n' and does remove on 'y'.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-11 | 1.0 | Initial draft | Sarah (PO) |
